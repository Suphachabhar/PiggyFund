{"ast":null,"code":"var _jsxFileName = \"/Users/suphachabharnigrodhananda/Desktop/4920/4920_project/src/context/GlobalState.js\";\nimport React, { createContext, useReducer, useState, useEffect } from 'react';\nimport AppReducer from './AppReducer';\nimport moment, { months } from 'moment';\nimport cookie from 'react-cookies';\nimport { Header } from '../components/Transaction/Header';\nimport './global.css';\nconst ITME_API = `https://be-4920.herokuapp.com/getall`; // Initial state\n\nconst initialState = {\n  transactions: [],\n  all_transactions: [],\n  month: moment().format('MMMM')\n}; // Create context\n\nexport const GlobalContext = createContext(initialState);\nexport const loginUser = () => {\n  return cookie.load('userInfo');\n}; // Provider component\n\nexport const GlobalProvider = ({\n  children\n}) => {\n  const [state, dispatch] = useReducer(AppReducer, initialState);\n  const [list, setList] = useState([]);\n  useEffect(() => {\n    const fetchData = async () => {\n      const url = `${ITME_API}`;\n      const response = await fetch(url);\n      const data = await response.json();\n      setList(data);\n      state.all_transactions = list;\n      state.transactions = list.filter(transaction => {\n        return moment(transaction.Time).format('MMMM').localeCompare(state.month) === 0;\n      }).sort(function (a, b) {\n        return moment(a.Time).diff(moment(b.Time));\n      });\n    };\n\n    fetchData();\n  });\n\n  function getRemoval(arr1) {\n    let arr = [...arr1];\n    let newarr = [];\n    let userid = loginUser();\n    var convertToCurrency = cookie.load('currency');\n\n    if (!convertToCurrency) {\n      cookie.save('currency', 'AUD', {\n        path: '/'\n      });\n    }\n\n    var rates = cookie.load('rate');\n\n    if (!rates) {\n      rates = 1;\n      cookie.save('rate', 1, {\n        path: '/'\n      });\n    }\n\n    for (const value of arr) {\n      if (value.UserID === parseInt(userid)) {\n        let baseAmount = parseInt(value.Amount);\n        let res = parseInt(baseAmount * rates);\n        value.newAmount = res.toString();\n        newarr.push(value);\n      }\n    }\n\n    return newarr;\n  }\n\n  function getRemovalAll(arr1) {\n    let arr = [...arr1];\n    let newarr = [];\n    let userid = loginUser();\n\n    for (const value of arr) {\n      if (value.UserID === parseInt(userid)) {\n        newarr.push(value);\n      }\n    }\n\n    cookie.save('trackerData', newarr, {\n      path: '/'\n    });\n    return newarr;\n  } // Actions\n\n\n  function deleteTransaction(id) {\n    dispatch({\n      type: 'DELETE_TRANSACTION',\n      payload: id\n    });\n  }\n\n  function addTransaction(transaction) {\n    dispatch({\n      type: 'ADD_TRANSACTION',\n      payload: transaction\n    });\n  }\n\n  const setMonthToDisplay = function (month) {\n    state.month = month;\n  };\n\n  return /*#__PURE__*/React.createElement(GlobalContext.Provider, {\n    value: {\n      transactions: getRemoval(state.transactions),\n      all_transactions: getRemovalAll(state.all_transactions),\n      deleteTransaction,\n      addTransaction\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"month_display\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    className: \"month\",\n    onChange: e => setMonthToDisplay(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }\n  }, months().map(month => {\n    if (moment().format('MMMM').localeCompare(month) === 0) {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        value: month,\n        selected: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 25\n        }\n      }, month);\n    } else {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        value: month,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 25\n        }\n      }, month);\n    }\n  }))), children);\n};","map":{"version":3,"sources":["/Users/suphachabharnigrodhananda/Desktop/4920/4920_project/src/context/GlobalState.js"],"names":["React","createContext","useReducer","useState","useEffect","AppReducer","moment","months","cookie","Header","ITME_API","initialState","transactions","all_transactions","month","format","GlobalContext","loginUser","load","GlobalProvider","children","state","dispatch","list","setList","fetchData","url","response","fetch","data","json","filter","transaction","Time","localeCompare","sort","a","b","diff","getRemoval","arr1","arr","newarr","userid","convertToCurrency","save","path","rates","value","UserID","parseInt","baseAmount","Amount","res","newAmount","toString","push","getRemovalAll","deleteTransaction","id","type","payload","addTransaction","setMonthToDisplay","e","target","map"],"mappings":"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","sourcesContent":["import React, { createContext, useReducer, useState, useEffect } from 'react';\nimport AppReducer from './AppReducer';\nimport moment, { months } from 'moment';\nimport cookie from 'react-cookies'\nimport { Header } from '../components/Transaction/Header';\nimport './global.css'\n\nconst ITME_API = `https://be-4920.herokuapp.com/getall`\n\n// Initial state\nconst initialState = {\n  transactions: [],\n  all_transactions: [],\n  month: moment().format('MMMM')\n}\n\n// Create context\nexport const GlobalContext = createContext(initialState);\n\nexport const loginUser = () => {\n  return cookie.load('userInfo')\n}\n\n\n// Provider component\nexport const GlobalProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(AppReducer, initialState);\n    const [list, setList] = useState([]);\n\n  useEffect(() => {\n    const fetchData = async () => {\n        const url = `${ITME_API}`;\n        const response = await fetch(url);\n        const data = await response.json();\n        setList(data);\n        state.all_transactions = list;\n        state.transactions = list.filter(transaction => { return moment(transaction.Time).format('MMMM').localeCompare(state.month) === 0; })\n            .sort(function (a, b) { return moment(a.Time).diff(moment(b.Time)); });\n    }\n    fetchData()\n  })\n\n  function getRemoval(arr1) {\n    let arr = [...arr1];\n    let newarr = [];\n    let userid = loginUser();\n    var convertToCurrency = cookie.load('currency');\n    if (!convertToCurrency) {\n      cookie.save('currency', 'AUD', { path: '/' });\n    }\n    var rates = cookie.load('rate');\n    if (!rates) {\n      rates = 1;\n      cookie.save('rate', 1, { path: '/' })\n    }\n    for (const value of arr) {\n        if (value.UserID === parseInt(userid)) {\n          let baseAmount = parseInt(value.Amount)\n          let res = parseInt(baseAmount * rates)\n          value.newAmount = res.toString()\n          newarr.push(value);\n        }\n    }\n    return newarr;\n  }\n\n  function getRemovalAll(arr1) {\n    let arr = [...arr1];\n    let newarr = [];\n    let userid = loginUser();\n    for (const value of arr) {\n        if (value.UserID === parseInt(userid)) {\n          newarr.push(value);\n        }\n    }\n    cookie.save('trackerData', newarr, { path: '/' })\n    return newarr;\n  }\n\n  // Actions\n  function deleteTransaction(id) {\n    dispatch({\n      type: 'DELETE_TRANSACTION',\n      payload: id\n    });\n  }\n\n  function addTransaction(transaction) {\n    dispatch({\n      type: 'ADD_TRANSACTION',\n      payload: transaction\n    });\n  }\n\n  const setMonthToDisplay = function(month) {\n    state.month = month;\n  };\n\n\n\n  return (<GlobalContext.Provider value={{\n    transactions: getRemoval(state.transactions),\n    all_transactions: getRemovalAll(state.all_transactions),\n    deleteTransaction,\n    addTransaction\n  }}>\n    <Header />\n    <div className=\"month_display\">\n      <select className=\"month\"\n        onChange={e => setMonthToDisplay(e.target.value)}\n        \n      >\n        {months().map(month => {\n            if (moment().format('MMMM').localeCompare(month) === 0) {\n                return (<option value={month} selected>{month}</option>)\n            } else {\n                return (<option value={month}>{month}</option>)\n            }\n        })}\n      </select>\n    </div>\n    \n    {children}\n  </GlobalContext.Provider>);\n}"]},"metadata":{},"sourceType":"module"}